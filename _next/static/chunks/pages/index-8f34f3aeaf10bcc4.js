(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(569)}])},569:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ke}});var i=s(5893),r=s(214),a=s.n(r),n=s(7294),c=s(6138),h=s.n(c),d=128,l=64,o=32,u=16,y=8,p=4,g=2,f=1,C=s(3933),b=s.n(C),m=n.forwardRef((function(e,t){var s=(0,n.useRef)(),r=(0,n.useRef)(),a=(0,n.useRef)(),c=(0,n.useRef)(),h=(0,n.useRef)(),d=(0,n.useRef)();return n.useImperativeHandle(t,(function(){return{get up(){return s.current},get right(){return r.current},get down(){return a.current},get left(){return a.current},get a(){return h.current},get b(){return h.current},keydownUp:function(){s.current.classList.add(b().active)},keyupUp:function(){s.current.classList.remove(b().active)},keydownRight:function(){r.current.classList.add(b().active)},keyupRight:function(){r.current.classList.remove(b().active)},keydownDown:function(){a.current.classList.add(b().active)},keyupDown:function(){a.current.classList.remove(b().active)},keydownLeft:function(){c.current.classList.add(b().active)},keyupLeft:function(){c.current.classList.remove(b().active)},keydownA:function(){h.current.classList.add(b().active)},keyupA:function(){h.current.classList.remove(b().active)},keydownB:function(){d.current.classList.add(b().active)},keyupB:function(){d.current.classList.remove(b().active)}}})),(0,i.jsxs)("div",{className:b()["action-buttons"],children:[(0,i.jsxs)("div",{className:b().dpad,children:[(0,i.jsx)("div",{ref:s,className:b()["up-button"],children:(0,i.jsx)("span",{className:"".concat(b().arrow," ").concat(b()["up-arrow"])})}),(0,i.jsx)("div",{ref:r,className:b()["right-button"],children:(0,i.jsx)("span",{className:"".concat(b().arrow," ").concat(b()["right-arrow"])})}),(0,i.jsx)("div",{ref:a,className:b()["down-button"],children:(0,i.jsx)("span",{className:"".concat(b().arrow," ").concat(b()["down-arrow"])})}),(0,i.jsx)("div",{className:b()["dent-button"],children:(0,i.jsx)("span",{className:b()["dent-circle"],children:(0,i.jsx)("span",{className:"".concat(b()["dent-highlight"])})})}),(0,i.jsx)("div",{ref:c,className:b()["left-button"],children:(0,i.jsx)("span",{className:"".concat(b().arrow," ").concat(b()["left-arrow"])})})]}),(0,i.jsx)("div",{ref:h,className:"".concat(b()["ab-button"]," ").concat(b()["a-button"]),children:(0,i.jsx)("span",{className:b()["button-height"],children:"A"})}),(0,i.jsx)("div",{ref:d,className:"".concat(b()["ab-button"]," ").concat(b()["b-button"]),children:(0,i.jsx)("span",{className:b()["button-height"],children:"B"})})]})}));function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function P(e,t,s){return t&&A(e.prototype,t),s&&A(e,s),e}var w=[10,254,20,2,40,4,80,6,160,8,60,10,14,12,26,14,12,16,24,18,48,20,96,22,192,24,72,26,16,28,32,30],B=[[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,1,1],[0,0,0,0,1,1,1,1],[1,1,1,1,1,1,0,0]],S=[4,8,16,32,64,96,128,160,202,254,380,508,762,1016,2034,4068],k=[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],L=[428,380,340,320,286,254,226,214,190,160,142,128,106,84,72,54],N=function(){function e(){v(this,e),this.volume=0,this.isEnabled=!1,this.bytesRemaining=0,this.isInterrupted=!1,this.isMuted=!0,this.isIRQEnabled=!1,this.isLoopEnabled=!1,this.frequency=0,this.loadCounter=0,this.sampleAddr=0,this.sampleLength=0,this.clocks=0,this.sampleBuffer=0,this.addr=0,this.bitsRemaining=0}var t=e.prototype;return t.tick=function(){this.isEnabled&&(this.clocks%(L[this.frequency]+1)===0&&this.outputUnit(),this.clocks++)},t.cpuWrite=function(e,t){switch(e){case 0:this.isIRQEnabled=!!(128&t),this.isLoopEnabled=!!(64&t),this.frequency=15&t,this.clocks=0,this.isIRQEnabled||(this.isInterrupted=!1);break;case 1:this.loadCounter=127&t,this.restart();break;case 2:this.sampleAddr=49152+64*t,this.restart();break;case 3:this.sampleLength=16*t+1,this.restart()}},t.outputUnit=function(){if(this.bitsRemaining<=0){if(this.isMuted)return;this.memoryReader(),this.bitsRemaining=8}1&this.sampleBuffer?this.volume=this.volume>125?127:this.volume+2:this.volume=this.volume<2?0:this.volume-2,this.sampleBuffer>>=1,this.bitsRemaining--},t.memoryReader=function(){this.bytesRemaining<=0||this.bitsRemaining>0||(this.sampleBuffer=this.cpuBus.readByte(this.addr),this.addr=this.addr>=65535?32768:this.addr+1,this.bytesRemaining--,this.bytesRemaining<=0&&(this.isLoopEnabled?this.restart():(this.isMuted=!0,this.isIRQEnabled&&(this.isInterrupted=!0,this.interrupt.irq()))))},t.restart=function(){this.addr=this.sampleAddr,this.bytesRemaining=this.sampleLength,this.isMuted=!1,this.volume=this.loadCounter},e}(),R=function(){function e(){v(this,e),this.volume=0,this.enabled=!1,this.lengthCounter=0,this.internalTimer=0,this.isConstant=!1,this.envelopeValue=0,this.envelopeVolume=0,this.envelopeCounter=0,this.isLengthCounterHalt=!1,this.isLoopNoise=!1,this.noisePeriod=0}var t=e.prototype;return t.tick=function(){this.isEnabled&&(0===this.internalTimer?(this.internalTimer=this.noisePeriod,this.process()):this.internalTimer--)},t.envelope=function(){this.isConstant||(this.envelopeCounter%(this.envelopeValue+1)===0&&(0===this.envelopeVolume?this.envelopeVolume=this.isLengthCounterHalt?15:0:this.envelopeVolume--),this.envelopeCounter++)},t.countLinear=function(){},t.countLength=function(){!this.isLengthCounterHalt&&this.lengthCounter>0&&this.lengthCounter--},t.sweep=function(){},t.cpuWrite=function(e,t){switch(e){case 0:this.isLengthCounterHalt=!!(32&t),this.isConstant=!!(16&t),this.envelopeValue=15&t,this.envelopeVolume=15,this.envelopeCounter=0;break;case 1:break;case 2:this.isLoopNoise=!!(128&t),this.noisePeriod=S[15&t],this.internalTimer=0;break;case 3:this.lengthCounter=w[t>>3]}},t.process=function(){this.isEnabled&&0!==this.lengthCounter?this.isConstant?this.volume=Math.floor(Math.random()*this.envelopeValue):this.volume=Math.floor(Math.random()*this.envelopeVolume):this.volume=0},P(e,[{key:"isEnabled",get:function(){return this.enabled},set:function(e){this.enabled=e,e||(this.lengthCounter=0)}}]),e}(),I=function(){function e(t){v(this,e),this.channel=t,this.volume=0,this.enabled=!1,this.lengthCounter=0,this.timer=0,this.internalTimer=0,this.counter=0,this.duty=0,this.isConstant=!1,this.envelopeValue=0,this.envelopeVolume=0,this.envelopeCounter=0,this.isEnvelopeLoop=!1,this.isSweepEnabled=!1,this.sweepPeriod=0,this.isSweepNegated=!1,this.sweepShift=0,this.sweepCounter=0}var t=e.prototype;return t.tick=function(){this.isEnabled&&(0===this.internalTimer?(this.internalTimer=this.timer,this.process()):this.internalTimer--)},t.envelope=function(){this.isConstant||(this.envelopeCounter%(this.envelopeValue+1)===0&&(0===this.envelopeVolume?this.envelopeVolume=this.isEnvelopeLoop?15:0:this.envelopeVolume--),this.envelopeCounter++)},t.countLinear=function(){},t.countLength=function(){!this.isEnvelopeLoop&&this.lengthCounter>0&&this.lengthCounter--},t.sweep=function(){if(this.isSweepEnabled){if(this.sweepCounter%(this.sweepPeriod+1)===0){var e=this.isSweepNegated?-(this.timer>>this.sweepShift):this.timer>>this.sweepShift;this.timer+=e,1===this.channel&&e<=0&&this.timer--}this.sweepCounter++}},t.cpuWrite=function(e,t){switch(e){case 0:this.duty=t>>6,this.isEnvelopeLoop=!!(32&t),this.isConstant=!!(16&t),this.envelopeValue=15&t,this.envelopeVolume=15,this.envelopeCounter=0;break;case 1:this.isSweepEnabled=!!(128&t),this.sweepPeriod=t>>4&7,this.isSweepNegated=!!(8&t),this.sweepShift=7&t,this.sweepCounter=0;break;case 2:this.timer=65280&this.timer|t;break;case 3:this.timer=255&this.timer|t<<8&2047,this.lengthCounter=w[t>>3],this.internalTimer=0}},t.process=function(){this.counter++,!this.isEnabled||0===this.lengthCounter||this.timer<8||this.timer>2047?this.volume=0:this.isConstant?this.volume=this.envelopeValue*B[this.duty][7&this.counter]:this.volume=this.envelopeVolume*B[this.duty][7&this.counter]},P(e,[{key:"isEnabled",get:function(){return this.enabled},set:function(e){this.enabled=e,e||(this.lengthCounter=0)}}]),e}(),X=function(){function e(){v(this,e),this.volume=0,this.enabled=!1,this.lengthCounter=0,this.timer=0,this.internalTimer=0,this.counter=0,this.isLengthCounterHalt=!1,this.linearCounterLoad=0,this.isLinearCounterReload=!1,this.linearCounterValue=0}var t=e.prototype;return t.tick=function(){this.isEnabled&&(0===this.internalTimer?(this.internalTimer=this.timer,this.process()):this.internalTimer--)},t.envelope=function(){},t.countLinear=function(){this.isLinearCounterReload?this.linearCounterValue=this.linearCounterLoad:this.linearCounterValue>0&&this.linearCounterValue--,this.isLengthCounterHalt||(this.isLinearCounterReload=!1)},t.countLength=function(){!this.isLengthCounterHalt&&this.lengthCounter>0&&this.lengthCounter--},t.sweep=function(){},t.cpuWrite=function(e,t){switch(e){case 0:this.isLengthCounterHalt=!!(128&t),this.linearCounterLoad=127&t;break;case 1:break;case 2:this.timer=65280&this.timer|t;break;case 3:this.timer=255&this.timer|t<<8&2047,this.lengthCounter=w[t>>3],this.isLinearCounterReload=!0,this.internalTimer=0}},t.process=function(){this.counter++,this.isEnabled&&0!==this.lengthCounter&&0!==this.linearCounterValue||this.counter--,this.volume=k[31&this.counter]},P(e,[{key:"isEnabled",get:function(){return this.enabled},set:function(e){this.enabled=e,e||(this.lengthCounter=0)}}]),e}(),E=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:48e3,s=arguments.length>1?arguments[1]:void 0;v(this,e),this.sampleRate=t,this.onSample=s,this.pulse1=new I(1),this.pulse2=new I(2),this.noise=new R,this.triangle=new X,this.dmc=new N,this.isFrameInterrupted=!1,this.mode=0,this.isIRQEnabled=!0,this.clocks=0,this.sampleCounter=0,this.frameCounter=0}var t=e.prototype;return t.tick=function(){this.clocks++,1&this.clocks&&(this.pulse1.tick(),this.pulse2.tick(),this.noise.tick()),this.dmc.tick(),this.triangle.tick();var e=Math.floor(this.clocks/(1789773/this.sampleRate));e!==this.sampleCounter&&(this.sampleCounter=e,this.sample());var t=Math.floor(this.clocks/7457.3875);t!==this.frameCounter&&(this.frameCounter=t,this.countFrame())},t.cpuRead=function(e){if(16405===e){var t=(this.pulse1.lengthCounter>0?1:0)|(this.pulse2.lengthCounter>0?2:0)|(this.triangle.lengthCounter>0?4:0)|(this.noise.lengthCounter>0?8:0)|(this.dmc.bytesRemaining>0?16:0)|(this.isFrameInterrupted?64:0)|(this.dmc.isInterrupted?128:0);return this.isFrameInterrupted=!1,t}return 0},t.cpuWrite=function(e,t){switch(e){case 16384:case 16385:case 16386:case 16387:this.pulse1.cpuWrite(e-16384,t);break;case 16388:case 16389:case 16390:case 16391:this.pulse2.cpuWrite(e-16388,t);break;case 16392:case 16393:case 16394:case 16395:this.triangle.cpuWrite(e-16392,t);break;case 16396:case 16397:case 16398:case 16399:this.noise.cpuWrite(e-16396,t);break;case 16400:case 16401:case 16402:case 16403:this.dmc.cpuWrite(e-16400,t);break;case 16405:this.pulse1.isEnabled=!!(1&t),this.pulse2.isEnabled=!!(2&t),this.triangle.isEnabled=!!(4&t),this.noise.isEnabled=!!(8&t),this.dmc.isEnabled=!!(16&t),this.dmc.isInterrupted=!1;break;case 16407:this.frameCounter=0,this.mode=t>>7,this.isIRQEnabled=!(64&t)}},t.sample=function(){var e=.00752*(this.pulse1.volume+this.pulse2.volume),t=.00851*this.triangle.volume+.00494*this.noise.volume+.00335*this.dmc.volume;this.onSample(e+t)},t.countFrame=function(){if(0===this.mode)switch(this.frameCounter%4){case 0:case 2:this.envelopeAndCountLinear();break;case 1:this.countLengthAndSweep(),this.envelopeAndCountLinear();break;case 3:this.irq(),this.countLengthAndSweep(),this.envelopeAndCountLinear()}else switch(this.frameCounter%5){case 0:case 2:this.envelopeAndCountLinear();break;case 1:case 4:this.countLengthAndSweep(),this.envelopeAndCountLinear()}},t.envelopeAndCountLinear=function(){this.pulse1.envelope(),this.pulse2.envelope(),this.noise.envelope(),this.triangle.countLinear()},t.countLengthAndSweep=function(){this.pulse1.countLength(),this.pulse2.countLength(),this.triangle.countLength(),this.noise.countLength(),this.pulse1.sweep(),this.pulse2.sweep()},t.irq=function(){this.isIRQEnabled&&(this.isFrameInterrupted=!0,this.interruptLine.irq())},P(e,[{key:"cpuBus",set:function(e){this.dmc.cpuBus=e}},{key:"interrupt",set:function(e){this.interruptLine=e,this.dmc.interrupt=e}}]),e}(),M=0,_=1,x=2,Y=3,D=4,O=function(){function e(){v(this,e)}var t=e.prototype;return t.readByte=function(e){return(e&=16383)<8192?this.rom.mapper.read(e):e<12288?this.ram.read(this.mirrored(e)):e<16128?this.readByte(e-4096):(e&=16159)<16144?this.bgPalette.read(e):3&e?this.spPalette.read(e):this.bgPalette.read(e-16)},t.writeByte=function(e,t){return(e&=16383)<8192?this.rom.mapper.write(e,t):e<12288?this.ram.write(this.mirrored(e),t):e<16128?this.writeByte(e-4096,t):(e&=16159)<16144?this.bgPalette.write(e,t):3&e?this.spPalette.write(e,t):this.bgPalette.write(e-16,t)},t.readWord=function(e){return this.readByte(e+1)<<8|this.readByte(e)},t.writeWord=function(e,t){this.writeByte(e,t),this.writeByte(e+1,t>>8)},t.mirrored=function(e){switch(this.rom.header.mirror){case M:return 9215&e|(2048&e?1024:0);case _:return 10239&e;case x:return e;case Y:return 9215&e;case D:return 10239&e;default:throw new Error("invalid mirror type: '".concat(this.rom.header.mirror,"'"))}},e}(),Z=function(){function e(){v(this,e)}var t=e.prototype;return t.writeByte=function(e,t){var s=this;return e<8192?this.ram.write(2047&e,t):e<16384?this.ppu.cpuWrite(8199&e,t):16404===e?this.dma.copy(t<<8):16406===e?function(e){s.player1.write(e),s.player2.write(e)}(t):e<16408?this.apu.cpuWrite(e,t):e<16416?void 0:this.rom.mapper.write(e,t)},t.writeWord=function(e,t){this.writeByte(e,255&t),this.writeByte(e+1,t>>8&255)},t.readByte=function(e){return e<8192?this.ram.read(2047&e):e<16384?this.ppu.cpuRead(8199&e):16404===e?0:16406===e?this.player1.read():16407===e?this.player2.read():e<16408?this.apu.cpuRead(e):e<16416?0:this.rom.mapper.read(e)},t.readWord=function(e){return 65535&(this.readByte(e+1)<<8|this.readByte(e))},e}(),T=function(){function e(){v(this,e),this.isStrobe=!1,this.offset=0}var t=e.prototype;return t.update=function(e,t){t?this.data|=e:this.data&=255&~e},t.write=function(e){1&e?this.isStrobe=!0:(this.offset=0,this.isStrobe=!1)},t.read=function(){return(this.isStrobe?this.data&d:this.data&128>>this.offset++)?1:0},e}(),V=1,j=2,W=4,H=8,U=16,z=32,F=64,q=128,Q=[{inst:"BRK",addr:"ZP0",bytes:2,cycles:7,pageCycles:0},{inst:"ORA",addr:"INX",bytes:2,cycles:6,pageCycles:0},void 0,{inst:"SLO",addr:"INX",bytes:2,cycles:8,pageCycles:0},{inst:"NOP",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"ORA",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"ASL",addr:"ZP0",bytes:2,cycles:5,pageCycles:0},{inst:"SLO",addr:"ZP0",bytes:2,cycles:5,pageCycles:0},{inst:"PHP",addr:"IMP",bytes:1,cycles:3,pageCycles:0},{inst:"ORA",addr:"IMM",bytes:2,cycles:2,pageCycles:0},{inst:"ASL",addr:"ACC",bytes:1,cycles:2,pageCycles:0},void 0,{inst:"NOP",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"ORA",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"ASL",addr:"ABS",bytes:3,cycles:6,pageCycles:0},{inst:"SLO",addr:"ABS",bytes:3,cycles:6,pageCycles:0},{inst:"BPL",addr:"REL",bytes:2,cycles:2,pageCycles:1},{inst:"ORA",addr:"INY",bytes:2,cycles:5,pageCycles:1},void 0,{inst:"SLO",addr:"INY",bytes:2,cycles:8,pageCycles:0},{inst:"NOP",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"ORA",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"ASL",addr:"ZPX",bytes:2,cycles:6,pageCycles:0},{inst:"SLO",addr:"ZPX",bytes:2,cycles:6,pageCycles:0},{inst:"CLC",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"ORA",addr:"ABY",bytes:3,cycles:4,pageCycles:1},{inst:"NOP",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"SLO",addr:"ABY",bytes:3,cycles:7,pageCycles:0},{inst:"NOP",addr:"ABX",bytes:3,cycles:4,pageCycles:1},{inst:"ORA",addr:"ABX",bytes:3,cycles:4,pageCycles:1},{inst:"ASL",addr:"ABX",bytes:3,cycles:7,pageCycles:0},{inst:"SLO",addr:"ABX",bytes:3,cycles:7,pageCycles:0},{inst:"JSR",addr:"ABS",bytes:3,cycles:6,pageCycles:0},{inst:"AND",addr:"INX",bytes:2,cycles:6,pageCycles:0},void 0,{inst:"RLA",addr:"INX",bytes:2,cycles:8,pageCycles:0},{inst:"BIT",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"AND",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"ROL",addr:"ZP0",bytes:2,cycles:5,pageCycles:0},{inst:"RLA",addr:"ZP0",bytes:2,cycles:5,pageCycles:0},{inst:"PLP",addr:"IMP",bytes:1,cycles:4,pageCycles:0},{inst:"AND",addr:"IMM",bytes:2,cycles:2,pageCycles:0},{inst:"ROL",addr:"ACC",bytes:1,cycles:2,pageCycles:0},void 0,{inst:"BIT",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"AND",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"ROL",addr:"ABS",bytes:3,cycles:6,pageCycles:0},{inst:"RLA",addr:"ABS",bytes:3,cycles:6,pageCycles:0},{inst:"BMI",addr:"REL",bytes:2,cycles:2,pageCycles:1},{inst:"AND",addr:"INY",bytes:2,cycles:5,pageCycles:1},void 0,{inst:"RLA",addr:"INY",bytes:2,cycles:8,pageCycles:0},{inst:"NOP",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"AND",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"ROL",addr:"ZPX",bytes:2,cycles:6,pageCycles:0},{inst:"RLA",addr:"ZPX",bytes:2,cycles:6,pageCycles:0},{inst:"SEC",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"AND",addr:"ABY",bytes:3,cycles:4,pageCycles:1},{inst:"NOP",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"RLA",addr:"ABY",bytes:3,cycles:7,pageCycles:0},{inst:"NOP",addr:"ABX",bytes:3,cycles:4,pageCycles:1},{inst:"AND",addr:"ABX",bytes:3,cycles:4,pageCycles:1},{inst:"ROL",addr:"ABX",bytes:3,cycles:7,pageCycles:0},{inst:"RLA",addr:"ABX",bytes:3,cycles:7,pageCycles:0},{inst:"RTI",addr:"IMP",bytes:1,cycles:6,pageCycles:0},{inst:"EOR",addr:"INX",bytes:2,cycles:6,pageCycles:0},void 0,{inst:"SRE",addr:"INX",bytes:2,cycles:8,pageCycles:0},{inst:"NOP",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"EOR",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"LSR",addr:"ZP0",bytes:2,cycles:5,pageCycles:0},{inst:"SRE",addr:"ZP0",bytes:2,cycles:5,pageCycles:0},{inst:"PHA",addr:"IMP",bytes:1,cycles:3,pageCycles:0},{inst:"EOR",addr:"IMM",bytes:2,cycles:2,pageCycles:0},{inst:"LSR",addr:"ACC",bytes:1,cycles:2,pageCycles:0},void 0,{inst:"JMP",addr:"ABS",bytes:3,cycles:3,pageCycles:0},{inst:"EOR",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"LSR",addr:"ABS",bytes:3,cycles:6,pageCycles:0},{inst:"SRE",addr:"ABS",bytes:3,cycles:6,pageCycles:0},{inst:"BVC",addr:"REL",bytes:2,cycles:2,pageCycles:1},{inst:"EOR",addr:"INY",bytes:2,cycles:5,pageCycles:1},void 0,{inst:"SRE",addr:"INY",bytes:2,cycles:8,pageCycles:0},{inst:"NOP",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"EOR",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"LSR",addr:"ZPX",bytes:2,cycles:6,pageCycles:0},{inst:"SRE",addr:"ZPX",bytes:2,cycles:6,pageCycles:0},{inst:"CLI",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"EOR",addr:"ABY",bytes:3,cycles:4,pageCycles:1},{inst:"NOP",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"SRE",addr:"ABY",bytes:3,cycles:7,pageCycles:0},{inst:"NOP",addr:"ABX",bytes:3,cycles:4,pageCycles:1},{inst:"EOR",addr:"ABX",bytes:3,cycles:4,pageCycles:1},{inst:"LSR",addr:"ABX",bytes:3,cycles:7,pageCycles:0},{inst:"SRE",addr:"ABX",bytes:3,cycles:7,pageCycles:0},{inst:"RTS",addr:"IMP",bytes:1,cycles:6,pageCycles:0},{inst:"ADC",addr:"INX",bytes:2,cycles:6,pageCycles:0},void 0,{inst:"RRA",addr:"INX",bytes:2,cycles:8,pageCycles:0},{inst:"NOP",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"ADC",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"ROR",addr:"ZP0",bytes:2,cycles:5,pageCycles:0},{inst:"RRA",addr:"ZP0",bytes:2,cycles:5,pageCycles:0},{inst:"PLA",addr:"IMP",bytes:1,cycles:4,pageCycles:0},{inst:"ADC",addr:"IMM",bytes:2,cycles:2,pageCycles:0},{inst:"ROR",addr:"ACC",bytes:1,cycles:2,pageCycles:0},void 0,{inst:"JMP",addr:"IND",bytes:3,cycles:5,pageCycles:0},{inst:"ADC",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"ROR",addr:"ABS",bytes:3,cycles:6,pageCycles:0},{inst:"RRA",addr:"ABS",bytes:3,cycles:6,pageCycles:0},{inst:"BVS",addr:"REL",bytes:2,cycles:2,pageCycles:1},{inst:"ADC",addr:"INY",bytes:2,cycles:5,pageCycles:1},void 0,{inst:"RRA",addr:"INY",bytes:2,cycles:8,pageCycles:0},{inst:"NOP",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"ADC",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"ROR",addr:"ZPX",bytes:2,cycles:6,pageCycles:0},{inst:"RRA",addr:"ZPX",bytes:2,cycles:6,pageCycles:0},{inst:"SEI",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"ADC",addr:"ABY",bytes:3,cycles:4,pageCycles:1},{inst:"NOP",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"RRA",addr:"ABY",bytes:3,cycles:7,pageCycles:0},{inst:"NOP",addr:"ABX",bytes:3,cycles:4,pageCycles:1},{inst:"ADC",addr:"ABX",bytes:3,cycles:4,pageCycles:1},{inst:"ROR",addr:"ABX",bytes:3,cycles:7,pageCycles:0},{inst:"RRA",addr:"ABX",bytes:3,cycles:7,pageCycles:0},{inst:"NOP",addr:"IMM",bytes:2,cycles:2,pageCycles:0},{inst:"STA",addr:"INX",bytes:2,cycles:6,pageCycles:0},{inst:"NOP",addr:"IMM",bytes:2,cycles:2,pageCycles:0},{inst:"SAX",addr:"INX",bytes:2,cycles:6,pageCycles:0},{inst:"STY",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"STA",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"STX",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"SAX",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"DEY",addr:"IMP",bytes:1,cycles:2,pageCycles:0},void 0,{inst:"TXA",addr:"IMP",bytes:1,cycles:2,pageCycles:0},void 0,{inst:"STY",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"STA",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"STX",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"SAX",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"BCC",addr:"REL",bytes:2,cycles:2,pageCycles:1},{inst:"STA",addr:"INY",bytes:2,cycles:6,pageCycles:0},void 0,void 0,{inst:"STY",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"STA",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"STX",addr:"ZPY",bytes:2,cycles:4,pageCycles:0},{inst:"SAX",addr:"ZPY",bytes:2,cycles:4,pageCycles:0},{inst:"TYA",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"STA",addr:"ABY",bytes:3,cycles:5,pageCycles:0},{inst:"TXS",addr:"IMP",bytes:1,cycles:2,pageCycles:0},void 0,void 0,{inst:"STA",addr:"ABX",bytes:3,cycles:5,pageCycles:0},void 0,void 0,{inst:"LDY",addr:"IMM",bytes:2,cycles:2,pageCycles:0},{inst:"LDA",addr:"INX",bytes:2,cycles:6,pageCycles:0},{inst:"LDX",addr:"IMM",bytes:2,cycles:2,pageCycles:0},{inst:"LAX",addr:"INX",bytes:2,cycles:6,pageCycles:0},{inst:"LDY",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"LDA",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"LDX",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"LAX",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"TAY",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"LDA",addr:"IMM",bytes:2,cycles:2,pageCycles:0},{inst:"TAX",addr:"IMP",bytes:1,cycles:2,pageCycles:0},void 0,{inst:"LDY",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"LDA",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"LDX",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"LAX",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"BCS",addr:"REL",bytes:2,cycles:2,pageCycles:1},{inst:"LDA",addr:"INY",bytes:2,cycles:5,pageCycles:1},void 0,{inst:"LAX",addr:"INY",bytes:2,cycles:5,pageCycles:1},{inst:"LDY",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"LDA",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"LDX",addr:"ZPY",bytes:2,cycles:4,pageCycles:0},{inst:"LAX",addr:"ZPY",bytes:2,cycles:4,pageCycles:0},{inst:"CLV",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"LDA",addr:"ABY",bytes:3,cycles:4,pageCycles:1},{inst:"TSX",addr:"IMP",bytes:1,cycles:2,pageCycles:0},void 0,{inst:"LDY",addr:"ABX",bytes:3,cycles:4,pageCycles:1},{inst:"LDA",addr:"ABX",bytes:3,cycles:4,pageCycles:1},{inst:"LDX",addr:"ABY",bytes:3,cycles:4,pageCycles:1},{inst:"LAX",addr:"ABY",bytes:3,cycles:4,pageCycles:1},{inst:"CPY",addr:"IMM",bytes:2,cycles:2,pageCycles:0},{inst:"CMP",addr:"INX",bytes:2,cycles:6,pageCycles:0},void 0,{inst:"DCP",addr:"INX",bytes:2,cycles:8,pageCycles:0},{inst:"CPY",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"CMP",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"DEC",addr:"ZP0",bytes:2,cycles:5,pageCycles:0},{inst:"DCP",addr:"ZP0",bytes:2,cycles:5,pageCycles:0},{inst:"INY",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"CMP",addr:"IMM",bytes:2,cycles:2,pageCycles:0},{inst:"DEX",addr:"IMP",bytes:1,cycles:2,pageCycles:0},void 0,{inst:"CPY",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"CMP",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"DEC",addr:"ABS",bytes:3,cycles:6,pageCycles:0},{inst:"DCP",addr:"ABS",bytes:3,cycles:6,pageCycles:0},{inst:"BNE",addr:"REL",bytes:2,cycles:2,pageCycles:1},{inst:"CMP",addr:"INY",bytes:2,cycles:5,pageCycles:1},void 0,{inst:"DCP",addr:"INY",bytes:2,cycles:8,pageCycles:0},{inst:"NOP",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"CMP",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"DEC",addr:"ZPX",bytes:2,cycles:6,pageCycles:0},{inst:"DCP",addr:"ZPX",bytes:2,cycles:6,pageCycles:0},{inst:"CLD",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"CMP",addr:"ABY",bytes:3,cycles:4,pageCycles:1},{inst:"NOP",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"DCP",addr:"ABY",bytes:3,cycles:7,pageCycles:0},{inst:"NOP",addr:"ABX",bytes:3,cycles:4,pageCycles:1},{inst:"CMP",addr:"ABX",bytes:3,cycles:4,pageCycles:1},{inst:"DEC",addr:"ABX",bytes:3,cycles:7,pageCycles:0},{inst:"DCP",addr:"ABX",bytes:3,cycles:7,pageCycles:0},{inst:"CPX",addr:"IMM",bytes:2,cycles:2,pageCycles:0},{inst:"SBC",addr:"INX",bytes:2,cycles:6,pageCycles:0},void 0,{inst:"ISC",addr:"INX",bytes:2,cycles:8,pageCycles:0},{inst:"CPX",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"SBC",addr:"ZP0",bytes:2,cycles:3,pageCycles:0},{inst:"INC",addr:"ZP0",bytes:2,cycles:5,pageCycles:0},{inst:"ISC",addr:"ZP0",bytes:2,cycles:5,pageCycles:0},{inst:"INX",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"SBC",addr:"IMM",bytes:2,cycles:2,pageCycles:0},{inst:"NOP",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"SBC",addr:"IMM",bytes:2,cycles:2,pageCycles:0},{inst:"CPX",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"SBC",addr:"ABS",bytes:3,cycles:4,pageCycles:0},{inst:"INC",addr:"ABS",bytes:3,cycles:6,pageCycles:0},{inst:"ISC",addr:"ABS",bytes:3,cycles:6,pageCycles:0},{inst:"BEQ",addr:"REL",bytes:2,cycles:2,pageCycles:1},{inst:"SBC",addr:"INY",bytes:2,cycles:5,pageCycles:1},void 0,{inst:"ISC",addr:"INY",bytes:2,cycles:8,pageCycles:0},{inst:"NOP",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"SBC",addr:"ZPX",bytes:2,cycles:4,pageCycles:0},{inst:"INC",addr:"ZPX",bytes:2,cycles:6,pageCycles:0},{inst:"ISC",addr:"ZPX",bytes:2,cycles:6,pageCycles:0},{inst:"SED",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"SBC",addr:"ABY",bytes:3,cycles:4,pageCycles:1},{inst:"NOP",addr:"IMP",bytes:1,cycles:2,pageCycles:0},{inst:"ISC",addr:"ABY",bytes:3,cycles:7,pageCycles:0},{inst:"NOP",addr:"ABX",bytes:3,cycles:4,pageCycles:1},{inst:"SBC",addr:"ABX",bytes:3,cycles:4,pageCycles:1},{inst:"INC",addr:"ABX",bytes:3,cycles:7,pageCycles:0},{inst:"ISC",addr:"ABX",bytes:3,cycles:7,pageCycles:0}],K=function e(){v(this,e),this.PC=0,this.SP=0,this.P=0,this.A=0,this.X=0,this.Y=0},G=function(){function e(){v(this,e),this.suspendCycles=0,this.deferCycles=0,this.registers=new K}var t=e.prototype;return t.tick=function(){this.suspendCycles>0?this.suspendCycles--:(0===this.deferCycles&&this.next(),this.deferCycles--)},t.next=function(){var e=this.bus.readByte(this.registers.PC++),t=Q[e];if(!t)throw new Error("invalid opcode '0x".concat(e.toString(16),"', pc: 0x").concat((this.registers.PC-1).toString(16)));if("???"!==t.inst){var s=this.address(t);s.crossing&&(this.deferCycles+=t.pageCycles),this.instruct(t,s),this.deferCycles+=t.cycles}},t.address=function(e){switch(e.addr){case"ABS":var t=this.bus.readWord(this.registers.PC);return this.registers.PC+=2,{addr:65535&t,data:NaN,crossing:!1};case"ABX":var s=this.bus.readWord(this.registers.PC);this.registers.PC+=2;var i=s+this.registers.X;return{addr:65535&i,data:NaN,crossing:this.isCrossing(s,i)};case"ABY":var r=this.bus.readWord(this.registers.PC);this.registers.PC+=2;var a=r+this.registers.Y;return{addr:65535&a,data:NaN,crossing:this.isCrossing(r,a)};case"ACC":return{addr:NaN,data:this.registers.A,crossing:!1};case"IMM":return{addr:NaN,data:this.bus.readByte(this.registers.PC++),crossing:!1};case"IMP":return{addr:NaN,data:NaN,crossing:!1};case"IND":var n=this.bus.readWord(this.registers.PC);return this.registers.PC+=2,{addr:65535&(n=255===(255&n)?this.bus.readByte(65280&n)<<8|this.bus.readByte(n):this.bus.readWord(n)),data:NaN,crossing:!1};case"INY":var c=this.bus.readByte(this.registers.PC++),h=this.bus.readByte(c+1&255)<<8|this.bus.readByte(255&c),d=h+this.registers.Y;return{addr:65535&d,data:NaN,crossing:this.isCrossing(h,d)};case"REL":var l=this.bus.readByte(this.registers.PC++);return 128&l&&(l-=256),{addr:this.registers.PC+l&65535,data:NaN,crossing:!1};case"INX":var o=this.bus.readByte(this.registers.PC++)+this.registers.X;return{addr:65535&(this.bus.readByte(o+1&255)<<8|this.bus.readByte(255&o)),data:NaN,crossing:!1};case"ZP0":return{addr:65535&this.bus.readByte(this.registers.PC++),data:NaN,crossing:!1};case"ZPX":return{addr:65535&(this.bus.readByte(this.registers.PC++)+this.registers.X&255),data:NaN,crossing:!1};case"ZPY":return{addr:65535&(this.bus.readByte(this.registers.PC++)+this.registers.Y&255),data:NaN,crossing:!1};default:throw new Error("unsuppored addressing mode: ".concat(e.addr))}},t.instruct=function(e,t){switch(e.inst){case"ADC":var s=this.fetch(t),i=s+this.registers.A+(this.check(V)?1:0);return this.flag(V,i>255),this.flag(F,!!(~(this.registers.A^s)&(this.registers.A^i)&128)),this.passthrough(i),void(this.registers.A=255&i);case"AND":return this.registers.A&=this.fetch(t),void this.passthrough(this.registers.A);case"ASL":var r=this.fetch(t)<<1;return this.flag(V,!!(256&r)),r&=255,this.passthrough(r),void(isNaN(t.addr)?this.registers.A=r:this.bus.writeByte(t.addr,r));case"BCC":return void(this.check(V)||(this.deferCycles++,this.isCrossing(this.registers.PC,t.addr)&&this.deferCycles++,this.registers.PC=t.addr));case"BCS":return void(this.check(V)&&(this.deferCycles++,this.isCrossing(this.registers.PC,t.addr)&&this.deferCycles++,this.registers.PC=t.addr));case"BEQ":return void(this.check(j)&&(this.deferCycles++,this.isCrossing(this.registers.PC,t.addr)&&this.deferCycles++,this.registers.PC=t.addr));case"BIT":var a=this.fetch(t);return this.flag(j,!(this.registers.A&a)),this.flag(q,!!(128&a)),void this.flag(F,!!(64&a));case"BMI":return void(this.check(q)&&(this.deferCycles++,this.isCrossing(this.registers.PC,t.addr)&&this.deferCycles++,this.registers.PC=t.addr));case"BNE":return void(this.check(j)||(this.deferCycles++,this.isCrossing(this.registers.PC,t.addr)&&this.deferCycles++,this.registers.PC=t.addr));case"BPL":return void(this.check(q)||(this.deferCycles++,this.isCrossing(this.registers.PC,t.addr)&&this.deferCycles++,this.registers.PC=t.addr));case"BRK":return this.pushWord(this.registers.PC),this.pushByte(this.registers.P|U|z),this.flag(W,!0),void(this.registers.PC=this.bus.readWord(65534));case"BVC":return void(this.check(F)||(this.deferCycles++,this.isCrossing(this.registers.PC,t.addr)&&this.deferCycles++,this.registers.PC=t.addr));case"BVS":return void(this.check(F)&&(this.deferCycles++,this.isCrossing(this.registers.PC,t.addr)&&this.deferCycles++,this.registers.PC=t.addr));case"CLC":return void this.flag(V,!1);case"CLD":return void this.flag(H,!1);case"CLI":return void this.flag(W,!1);case"CLV":return void this.flag(F,!1);case"CMP":var n=this.fetch(t),c=this.registers.A-n;return this.flag(V,this.registers.A>=n),void this.passthrough(c);case"CPX":var h=this.fetch(t),d=this.registers.X-h;return this.flag(V,this.registers.X>=h),void this.passthrough(d);case"CPY":var l=this.fetch(t),o=this.registers.Y-l;return this.flag(V,this.registers.Y>=l),void this.passthrough(o);case"DEC":var u=this.fetch(t)-1&255;return this.bus.writeByte(t.addr,u),void this.passthrough(u);case"DEX":return this.registers.X=this.registers.X-1&255,void this.passthrough(this.registers.X);case"DEY":return this.registers.Y=this.registers.Y-1&255,void this.passthrough(this.registers.Y);case"EOR":return this.registers.A^=this.fetch(t),void this.passthrough(this.registers.A);case"INC":var y=this.fetch(t)+1&255;return this.bus.writeByte(t.addr,y),void this.passthrough(y);case"INX":return this.registers.X=this.registers.X+1&255,void this.passthrough(this.registers.X);case"INY":return this.registers.Y=this.registers.Y+1&255,void this.passthrough(this.registers.Y);case"JMP":return void(this.registers.PC=t.addr);case"JSR":return this.pushWord(this.registers.PC-1),void(this.registers.PC=t.addr);case"LDA":return this.registers.A=this.fetch(t),void this.passthrough(this.registers.A);case"LDX":return this.registers.X=this.fetch(t),void this.passthrough(this.registers.X);case"LDY":return this.registers.Y=this.fetch(t),void this.passthrough(this.registers.Y);case"LSR":var p=this.fetch(t);return this.flag(V,!!(1&p)),p>>=1,this.passthrough(p),void(isNaN(t.addr)?this.registers.A=p:this.bus.writeByte(t.addr,p));case"NOP":return;case"ORA":return this.registers.A|=this.fetch(t),void this.passthrough(this.registers.A);case"PHA":return void this.pushByte(this.registers.A);case"PHP":return void this.pushByte(this.registers.P|U|z);case"PLA":return this.registers.A=this.popByte(),void this.passthrough(this.registers.A);case"PLP":return this.registers.P=this.popByte(),this.flag(U,!1),void this.flag(z,!0);case"ROL":var g=this.fetch(t),f=this.check(V);return this.flag(V,!!(128&g)),g=255&(g<<1|(f?1:0)),this.passthrough(g),void(isNaN(t.addr)?this.registers.A=g:this.bus.writeByte(t.addr,g));case"ROR":var C=this.fetch(t),b=this.check(V);return this.flag(V,!!(1&C)),C=C>>1|(b?128:0),this.passthrough(C),void(isNaN(t.addr)?this.registers.A=C:this.bus.writeByte(t.addr,C));case"RTI":return this.registers.P=this.popByte(),this.flag(U,!1),this.flag(z,!0),void(this.registers.PC=this.popWord());case"RTS":return void(this.registers.PC=this.popWord()+1);case"SBC":var m=this.fetch(t),v=this.registers.A-m-(this.check(V)?0:1);return this.passthrough(v),this.flag(V,v>=0),this.flag(F,!!((v^this.registers.A)&(v^m^255)&128)),void(this.registers.A=255&v);case"SEC":return void this.flag(V,!0);case"SED":return void this.flag(H,!0);case"SEI":return void this.flag(W,!0);case"STA":return void this.bus.writeByte(t.addr,this.registers.A);case"STX":return void this.bus.writeByte(t.addr,this.registers.X);case"STY":return void this.bus.writeByte(t.addr,this.registers.Y);case"TAX":return this.registers.X=this.registers.A,void this.passthrough(this.registers.X);case"TAY":return this.registers.Y=this.registers.A,void this.passthrough(this.registers.Y);case"TSX":return this.registers.X=this.registers.SP,void this.passthrough(this.registers.X);case"TXA":return this.registers.A=this.registers.X,void this.passthrough(this.registers.A);case"TXS":return void(this.registers.SP=this.registers.X);case"TYA":return this.registers.A=this.registers.Y,void this.passthrough(this.registers.A);default:throw new Error("unsuppored instruction: ".concat(e.inst))}},t.rst=function(){this.registers.A=0,this.registers.X=0,this.registers.Y=0,this.registers.P=0,this.registers.SP=253,this.registers.PC=this.bus.readWord(65532),this.deferCycles=8},t.irq=function(){this.check(W)||(this.pushWord(this.registers.PC),this.pushByte((this.registers.P|z)&~U),this.flag(W,!0),this.registers.PC=this.bus.readWord(65534),this.deferCycles+=7)},t.nmi=function(){this.pushWord(this.registers.PC),this.pushByte((this.registers.P|z)&~U),this.flag(W,!0),this.registers.PC=this.bus.readWord(65530),this.deferCycles+=7},t.fetch=function(e){return isNaN(e.data)?this.bus.readByte(e.addr):e.data},t.flag=function(e,t){t?this.registers.P|=e:this.registers.P&=~e},t.check=function(e){return!!(this.registers.P&e)},t.passthrough=function(e){this.flag(j,0===(255&e)),this.flag(q,!!(128&e))},t.pushWord=function(e){this.pushByte(e>>8),this.pushByte(e)},t.pushByte=function(e){this.bus.writeByte(256+this.registers.SP,e),this.registers.SP=this.registers.SP-1&255},t.popWord=function(){return this.popByte()|this.popByte()<<8},t.popByte=function(){return this.registers.SP=this.registers.SP+1&255,this.bus.readByte(256+this.registers.SP)},t.isCrossing=function(e,t){return(65280&e)!==(65280&t)},e}(),J=function(){function e(){v(this,e)}return e.prototype.copy=function(e){for(var t=new Uint8Array(256),s=0;s<256;s++)t[s]=this.cpu.bus.readByte(e+s);this.ppu.dma(t),this.cpu.suspendCycles=1&this.cpu.cycles?513:514},e}(),$=function(){function e(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;v(this,e),this.offset=s,this.data=new Uint8Array(t)}var t=e.prototype;return t.read=function(e){return this.data[e-this.offset&65535]},t.write=function(e,t){this.data[e-this.offset&65535]=t},e}(),ee=function(){function e(){v(this,e)}var t=e.prototype;return t.irq=function(){this.cpu.irq()},t.nmi=function(){this.cpu.nmi()},e}(),te=8,se=16,ie=[8192,9216,10240,11264],re=function(){function e(){v(this,e),this.ntableAddr=ie[0],this.vramInc=1,this.spPttrAddr=0,this.bgPttrAddr=0,this.spSize=te,this.isNMIEnabled=!1}return P(e,[{key:"data",get:function(){return ie.indexOf(this.ntableAddr)|(1===this.vramInc?0:1)<<2|(this.spPttrAddr?1:0)<<3|(this.bgPttrAddr?1:0)<<4|(this.spSize===te?0:1)<<5|(this.isNMIEnabled?1:0)<<7},set:function(e){this.ntableAddr=ie[3&e],this.vramInc=4&e?32:1,this.spPttrAddr=8&e?4096:0,this.bgPttrAddr=16&e?4096:0,this.spSize=32&e?se:te,this.isNMIEnabled=!!(128&e)}}]),e}(),ae=function(){function e(){v(this,e)}return P(e,[{key:"data",get:function(){return(this.isColorful?0:1)|(this.isShowBgLeft8px?1:0)<<1|(this.isShowSpLeft8px?1:0)<<2|(this.isShowBg?1:0)<<3|(this.isShowSp?1:0)<<4|(this.emphasizeRed?1:0)<<5|(this.emphasizeGreen?1:0)<<6|(this.emphasizeBlue?1:0)<<7},set:function(e){this.isColorful=!(1&e),this.isShowBgLeft8px=!!(2&e),this.isShowSpLeft8px=!!(4&e),this.isShowBg=!!(8&e),this.isShowSp=!!(16&e),this.emphasizeRed=!!(32&e),this.emphasizeGreen=!!(64&e),this.emphasizeBlue=!!(128&e)}}]),e}(),ne=function(){function e(){v(this,e)}return P(e,[{key:"data",get:function(){return(this.isSpOverflow?32:0)|(this.isZeroSpHit?64:0)|(this.isVBlankStarted?128:0)}}]),e}(),ce=function(){function e(t){v(this,e),this.onFrame=t,this.pixels=new Uint8Array(61440),this.oam1=new Uint8Array(256),this.controller=new re,this.mask=new ae,this.status=new ne,this.register={vramaddr:0,tramaddr:0,fineX:0,toggle:!1},this.shifter={},this.latch={},this.nmiDelay=0,this.frame=0,this.scanLine=240,this.cycle=340,this.oamAddr=0,this.oam2=Array(8).fill(0).map((function(){return Object.create(null)})),this.spritePixels=new Array(256)}var t=e.prototype;return t.tick=function(){261===this.scanLine&&339===this.cycle&&1&this.frame&&(this.mask.isShowBg||this.mask.isShowSp)&&this.ticked(),this.ticked(),(this.mask.isShowBg||this.mask.isShowSp)&&(0<=this.scanLine&&this.scanLine<=239&&(1===this.cycle&&this.clearSp(),65===this.cycle&&this.evaluateSp(),1<=this.cycle&&this.cycle<=256&&(this.shiftBg(),this.draw(),this.fetchBg()),256===this.cycle&&this.scrollY(),257===this.cycle&&this.copyHBits(),257===this.cycle&&this.fetchSp(),321<=this.cycle&&this.cycle<=336&&(this.shiftBg(),this.fetchBg())),261===this.scanLine&&(1<=this.cycle&&this.cycle<=256&&(this.shiftBg(),this.fetchBg()),256===this.cycle&&this.scrollY(),257===this.cycle&&this.copyHBits(),280===this.cycle&&this.copyVBits(),321<=this.cycle&&this.cycle<=336&&(this.shiftBg(),this.fetchBg())))},t.cpuRead=function(e){switch(e){case 8192:return this.controller.data;case 8193:return this.mask.data;case 8194:var t=this.status.data|this.latch.status;return this.status.isVBlankStarted=!1,this.register.toggle=!1,t;case 8195:case 8197:case 8198:return 0;case 8196:return this.oam1[this.oamAddr];case 8199:var s=this.bus.readByte(this.register.vramaddr);if(this.register.vramaddr<=16127){var i=this.register.tramaddr;this.register.tramaddr=s,s=i}else this.register.tramaddr=this.bus.readByte(this.register.vramaddr-4096);return this.register.vramaddr+=this.controller.vramInc,this.register.vramaddr&=32767,s}return 0},t.cpuWrite=function(e,t){switch(t&=255,this.latch.status=31&t,e){case 8192:this.controller.data=t,this.register.tramaddr=62463&this.register.tramaddr|(3&t)<<10;break;case 8193:this.mask.data=t;break;case 8194:break;case 8195:this.oamAddr=t;break;case 8196:this.oam1[255&this.oamAddr++]=t;break;case 8197:this.register.toggle?(this.register.tramaddr=3103&this.register.tramaddr|(7&t)<<12|(248&t)<<2,this.register.toggle=!1):(this.register.tramaddr=65504&this.register.tramaddr|t>>3,this.register.fineX=7&t,this.register.toggle=!0);break;case 8198:this.register.toggle?(this.register.tramaddr=65280&this.register.tramaddr|t,this.register.vramaddr=this.register.tramaddr,this.register.toggle=!1):(this.register.tramaddr=33023&this.register.tramaddr|(63&t)<<8,this.register.toggle=!0);break;case 8199:this.bus.writeByte(this.register.vramaddr,t),this.register.vramaddr+=this.controller.vramInc}},t.dma=function(e){for(var t=0;t<256;t++)this.oam1[t+this.oamAddr&255]=e[t]},t.ticked=function(){this.status.isVBlankStarted&&this.controller.isNMIEnabled&&0===this.nmiDelay--&&this.interrupt.nmi(),this.cycle++,this.cycle>340&&(this.cycle=0,this.scanLine++,this.scanLine>261&&(this.scanLine=0,this.frame++,this.onFrame(this.pixels))),241===this.scanLine&&1===this.cycle&&(this.status.isVBlankStarted=!0,this.controller.isNMIEnabled&&(this.nmiDelay=15)),261===this.scanLine&&1===this.cycle&&(this.status.isVBlankStarted=!1,this.status.isZeroSpHit=!1,this.status.isSpOverflow=!1),(this.mask.isShowBg||this.mask.isShowSp)&&this.mapper.handlePPUClock(this.scanLine,this.cycle)},t.fetchBg=function(){if(this.mask.isShowBg)switch(7&this.cycle){case 1:this.shifter.bgLo|=this.latch.bgLo,this.shifter.bgHi|=this.latch.bgHi,this.shifter.bgAttrLo|=1&this.latch.attr?255:0,this.shifter.bgAttrHi|=2&this.latch.attr?255:0;var e=8192|4095&this.register.vramaddr;this.latch.ntable=this.bus.readByte(e);break;case 3:var t=9152|3072&this.register.vramaddr|this.register.vramaddr>>4&56|this.register.vramaddr>>2&7,s=!!(2&this.register.vramaddr),i=(!!(64&this.register.vramaddr)?2:0)|(s?1:0);this.latch.attr=this.bus.readByte(t)>>(i<<1)&3;break;case 5:var r=this.controller.bgPttrAddr+16*this.latch.ntable+(this.register.vramaddr>>12&7);this.latch.bgLo=this.bus.readByte(r);break;case 7:var a=this.controller.bgPttrAddr+16*this.latch.ntable+(this.register.vramaddr>>12&7)+8;this.latch.bgHi=this.bus.readByte(a);break;case 0:31===(31&this.register.vramaddr)?(this.register.vramaddr&=-32,this.register.vramaddr^=1024):this.register.vramaddr+=1}},t.shiftBg=function(){this.mask.isShowBg&&(this.shifter.bgLo<<=1,this.shifter.bgHi<<=1,this.shifter.bgAttrLo<<=1,this.shifter.bgAttrHi<<=1)},t.scrollY=function(){if(28672!==(28672&this.register.vramaddr))this.register.vramaddr+=4096;else{this.register.vramaddr&=-28673;var e=(992&this.register.vramaddr)>>5;29===e?(e=0,this.register.vramaddr^=2048):31===e?e=0:e+=1,this.register.vramaddr=-993&this.register.vramaddr|e<<5}},t.copyHBits=function(){this.register.vramaddr=64480&this.register.vramaddr|-64481&this.register.tramaddr&32767},t.copyVBits=function(){this.register.vramaddr=33823&this.register.vramaddr|-33824&this.register.tramaddr&32767},t.draw=function(){var e=this.cycle-1,t=this.scanLine,s=32768>>this.register.fineX,i=(this.shifter.bgAttrHi&s?1:0)<<3|(this.shifter.bgAttrLo&s?1:0)<<2|(this.shifter.bgHi&s?1:0)<<1|(this.shifter.bgLo&s?1:0)<<0,r=63&this.spritePixels[e],a=r%4===0||!this.mask.isShowSp,n=16128;i%4===0||!this.mask.isShowBg?a||(n=16144+r):a?n=16128+i:(128&this.spritePixels[e]&&this.mask.isShowBg&&this.mask.isShowSp&&(0>e||e>7||this.mask.isShowSpLeft8px&&this.mask.isShowBgLeft8px)&&255!==e&&(this.status.isZeroSpHit=!0),n=64&this.spritePixels[e]?16128+i:16144+r),this.pixels[e+256*t]=this.bus.readByte(n)},t.clearSp=function(){this.mask.isShowSp&&this.oam2.forEach((function(e){e.attr=255,e.tile=255,e.x=255,e.y=255}))},t.evaluateSp=function(){if(this.mask.isShowSp)for(var e=0,t=0;t<64;t++){var s=this.oam1[4*t];if(!(this.scanLine<s||this.scanLine>=s+this.controller.spSize)){if(8===e){this.status.isSpOverflow=!0;break}var i=this.oam2[e++];i.y=s,i.tile=this.oam1[4*t+1],i.attr=this.oam1[4*t+2],i.x=this.oam1[4*t+3],i.isZero=0===t}}},t.fetchSp=function(){if(this.mask.isShowSp){this.spritePixels.fill(0);var e=!0,t=!1,s=void 0;try{for(var i,r=this.oam2.reverse()[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var a=i.value;if(!(a.y>=239)){var n=!!(32&a.attr),c=a.isZero,h=!!(64&a.attr),d=!!(128&a.attr),l=void 0;if(this.controller.spSize===te){l=this.controller.spPttrAddr+(a.tile<<4)+(d?7-this.scanLine+a.y:this.scanLine-a.y)}else{var o=(1&a.tile?4096:0)+((254&a.tile)<<4),u=d?15-this.scanLine+a.y:this.scanLine-a.y;l=o+u%8+16*Math.floor(u/8)}for(var y=this.bus.readByte(l+0),p=this.bus.readByte(l+8),g=0;g<8;g++){var f=h?1<<g:128>>g,C=(2&a.attr?1:0)<<3|(1&a.attr?1:0)<<2|(p&f?1:0)<<1|(y&f?1:0);C%4===0&&(63&this.spritePixels[a.x+g])%4!==0||(this.spritePixels[a.x+g]=C|(n?64:0)|(c?128:0))}}}}catch(b){t=!0,s=b}finally{try{e||null==r.return||r.return()}finally{if(t)throw s}}}},e}(),he=function(){function e(t,s,i,r){v(this,e),this.rom=t,this.ram=s,this.prg=i,this.chr=r,this.isMirrored=16384===i.length,0===r.length&&(this.chr=new Uint8Array(8192))}var t=e.prototype;return t.read=function(e){return(e&=65535)<8192?this.chr[this.map(e)]:e>=32768?this.prg[this.map(e)]:e>=24576?this.ram[e-24576]:0},t.write=function(e,t){(e&=65535)<8192?this.chr[this.map(e)]=t:e>=32768?this.prg[this.map(e)]=t:e>=24576&&(this.ram[e-24576]=t)},t.handlePPUClock=function(e,t){},t.map=function(e){return e<8192?e:(this.isMirrored?49151&e:e)-32768},e}(),de=function(){function e(t,s,i,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i.length>>14;v(this,e),this.rom=t,this.ram=s,this.prg=i,this.chr=r,this.prgBanks=a,this.shifter=16,this.chrBankMode=0,this.chrBanks=[0,0],this.prgBankMode=0,this.prgBank=0,this.chr=new Uint8Array(131072),this.chr.set(r),this.prgBankMode=3}var t=e.prototype;return t.read=function(e){return(e&=65535)<8192?this.readChr(e):e>=32768?this.readPrg(e):e>=24576?this.ram[e-24576]:0},t.write=function(e,t){(e&=65535)<8192?this.writeChr(e,t):e>=32768?this.readReg(e,t):e>=24576&&(this.ram[e-24576]=t)},t.handlePPUClock=function(e,t){},t.readReg=function(e,t){if(128&t)this.shifter=16,this.prgBankMode=3;else{var s=!!(1&this.shifter);this.shifter>>=1,this.shifter|=1&t?16:0,s&&(this.writeReg(e,this.shifter),this.shifter=16)}},t.writeReg=function(e,t){if(e<40960){switch(3&t){case 0:this.rom.header.mirror=Y;break;case 1:this.rom.header.mirror=D;break;case 2:this.rom.header.mirror=_;break;case 3:this.rom.header.mirror=M}return this.prgBankMode=t>>2&3,void(this.chrBankMode=t>>4&1)}e<49152?this.chrBanks[0]=31&t:e<57344?this.chrBanks[1]=31&t:this.prgBank=15&t},t.readChr=function(e){return this.chr[this.chrOffset(e)]},t.writeChr=function(e,t){this.chr[this.chrOffset(e)]=t},t.readPrg=function(e){return this.prg[this.prgOffset(e)]},t.chrOffset=function(e){return this.chrBankMode?(this.chrBanks[e>>12]<<12)+(4095&e):((30&this.chrBanks[0])<<12)+e},t.prgOffset=function(e){switch(e-=32768,this.prgBankMode){case 0:case 1:return((14&this.prgBank)<<14)+e;case 2:return e>>14===0?16383&e:(this.prgBank<<14)+(16383&e);case 3:return e>>14===0?(this.prgBank<<14)+(16383&e):(this.prgBanks-1<<14)+(16383&e)}},e}(),le=function(){function e(t,s,i,r){v(this,e),this.rom=t,this.ram=s,this.prg=i,this.chr=r,this.bankSelect=0,this.chr=new Uint8Array(8192),this.chr.set(r)}var t=e.prototype;return t.read=function(e){return(e&=65535)<8192?this.chr[e]:e>=32768?e<49152?this.prg[(this.bankSelect<<14)+e-32768]:this.prg[this.prg.length-16384+(e-49152)]:e>=24576?this.ram[e-24576]:0},t.write=function(e,t){(e&=65535)<8192?this.chr[e]=t:e>=32768?this.bankSelect=15&t:e>=24576&&(this.ram[e-24576]=t)},t.handlePPUClock=function(e,t){},e}(),oe=function(){function e(t,s,i,r){v(this,e),this.rom=t,this.ram=s,this.prg=i,this.chr=r,this.chrBankSelect=0,this.chr=new Uint8Array(32768),this.chr.set(r),this.prg=new Uint8Array(32768),this.prg.set(i),16384===i.length&&this.prg.set(i,16384)}var t=e.prototype;return t.read=function(e){return(e&=65535)<8192?this.chr[(this.chrBankSelect<<13)+e]:e>=32768?this.prg[e-32768]:e>=24576?this.ram[e-24576]:0},t.write=function(e,t){(e&=65535)<8192?this.chr[(this.chrBankSelect<<13)+e]=t:e>=32768?this.chrBankSelect=3&t:e>=24576&&(this.ram[e-24576]=t)},t.handlePPUClock=function(e,t){},e}(),ue=function(){function e(t,s){v(this,e),this.header={},e.check(t),this.parse(t);var i=t.slice(this.header.isTrained?528:16,(this.header.isTrained?528:16)+16*this.header.prg*1024),r=t.slice((this.header.isTrained?528:16)+i.length,(this.header.isTrained?528:16)+i.length+8*this.header.chr*1024);switch(this.header.mapper){case 0:this.mapper=new he(this,s,i,r);break;case 1:this.mapper=new de(this,s,i,r);break;case 2:this.mapper=new le(this,s,i,r);break;case 3:this.mapper=new oe(this,s,i,r);break;default:throw new Error("unsupported mapper: ".concat(this.header.mapper))}}return e.prototype.parse=function(e){this.header.prg=e[4],this.header.chr=e[5],this.header.mapper=e[7]>>4<<4|e[6]>>4,this.header.mirror=8&e[6]?x:1&e[6]?_:M,this.header.hasBattery=!!(2&e[6]),this.header.isTrained=!!(4&e[6])},e.check=function(e){for(var t="NES\x1a",s=0;s<t.length;s++)if(e[s]!==t.charCodeAt(s))throw new Error("Invalid nes file");if(8===(12&e[7]))throw new Error("NES2.0 is not currently supported")},e}(),ye=[8421504,187,3604671,8650918,12255338,11993118,11730944,9512448,8071936,15872,18445,15394,12134,0,328965,328965,13158600,23039,4472063,12006348,16724906,16725854,16725786,13978368,12870144,3963648,1999893,38246,33988,1118481,592137,592137,16777215,38399,7308543,13987839,16742348,16740249,16743257,16748895,16753203,10927872,5364074,5100974,55807,6710886,855309,855309,16777215,8699903,12303359,13679615,16760810,16760780,16762039,16764078,16767394,13427097,11464375,11204590,11792127,14540253,1118481,1118481];var pe=function(){function e(t,s){var i=this;v(this,e),s=this.parse(s),this.sram=new Uint8Array(8192),this.sram.set(s.sramLoad);var r=new T,a=new T,n=new G,c=new ce((function(e){return s.onFrame(i.palette(e))})),h=new E(s.sampleRate,s.onSample),d=new J,l=new ue(t,this.sram),o=new $(2048,8192),u=new $(2048,0),y=new Z,p=new O,g=new $(16,16128),f=new $(16,16144),C=new ee;n.bus=y,c.interrupt=C,c.bus=p,c.mapper=l.mapper,h.cpuBus=y,h.interrupt=C,d.cpu=n,d.ppu=c,C.cpu=n,p.rom=l,p.ram=o,p.bgPalette=g,p.spPalette=f,y.rom=l,y.ram=u,y.ppu=c,y.apu=h,y.dma=d,y.player1=r,y.player2=a,l.mapper.interrupt=C,this.cpu=n,this.ppu=c,this.apu=h,this.rom=l,this.ppuRam=o,this.cpuRam=u,this.cpuBus=y,this.ppuBus=p,this.bgPalette=g,this.spPalette=f,this.dma=d,this.player1=r,this.player2=a,this.cpu.rst()}var t=e.prototype;return t.tick=function(){this.cpu.tick(),this.apu.tick(),this.ppu.tick(),this.ppu.tick(),this.ppu.tick()},t.frame=function(){for(var e=this.ppu.frame;;){if(this.tick(),this.ppu.frame!==e)break}},t.palette=function(e){var t=new Uint32Array(e.length),s=0;return e.forEach((function(e){t[s++]=ye[e]})),t},t.parse=function(e){return{sampleRate:(e=e||{}).sampleRate||48e3,onSample:e.onSample||function(){},onFrame:e.onFrame||function(){},sramLoad:e.sramLoad||new Uint8Array(8192)}},e}(),ge=function(){function e(t,s,i){var r=this;v(this,e),i=this.parse(i),this.bufferSize=i.bufferSize,this.width=i.width,this.height=i.height,this.visCtx=t.getContext("2d"),"undefined"!==typeof AudioContext&&(this.audCtx=new AudioContext({sampleRate:i.sampleRate}),this.source=this.audCtx.createBufferSource(),this.node=this.audCtx.createScriptProcessor(this.bufferSize,0,1)),this.buffer=[],this.nes=new pe(s,{sampleRate:this.sampleRate,onSample:function(e){return r.onSample(e)},onFrame:function(e){return r.onFrame(e)},sramLoad:void 0})}var t=e.prototype;return t.start=function(){var e=this;"undefined"!==typeof AudioContext&&(this.node.onaudioprocess=function(t){return e.process(t)},this.source.connect(this.node),this.node.connect(this.audCtx.destination),this.source.start()),this.intervalID=setInterval((function(){e.waitSample()}),1)},t.onSample=function(e){this.buffer.push(e)},t.onFrame=function(e){for(var t=this.visCtx.createImageData(this.width,this.height),s=0,i=0;i<this.height;i++)for(var r=0;r<this.width;r++){var a=i*this.width+r;t.data[s++]=e[a]>>16&255,t.data[s++]=e[a]>>8&255,t.data[s++]=e[a]>>0&255,t.data[s++]=255}this.visCtx.putImageData(t,0,0)},t.parse=function(e){return{sampleRate:(e=e||{}).sampleRate||24e3,bufferSize:e.bufferSize||256,width:e.width||256,height:e.height||240}},t.process=function(e){for(var t=e.outputBuffer.getChannelData(0),s=0;s<t.length;s++)t[s]=this.buffer.shift()},t.waitSample=function(){try{if("undefined"!==typeof AudioContext)for(;this.buffer.length<4*this.bufferSize;)this.nes.tick();else this.nes.frame()}catch(e){this.visCtx.clearRect(0,0,this.width,this.height),this.visCtx.textAlign="center",this.visCtx.fillText(e,128,120),this.intervalID&&clearInterval(this.intervalID)}},P(e,[{key:"sampleRate",get:function(){return"undefined"!==typeof AudioContext?this.audCtx.sampleRate:void 0}}]),e}(),fe=s(3066),Ce=s.n(fe),be=function(e){return(0,i.jsx)("div",{className:Ce().logo,children:"WebNES"})},me=s(5309),ve=s.n(me),Ae=n.forwardRef((function(e,t){var s=(0,n.useRef)(),r=(0,n.useRef)(),a=(0,n.useRef)();return n.useImperativeHandle(t,(function(){return{keydownStart:function(){s.current.classList.add(ve().active)},keyupStart:function(){s.current.classList.remove(ve().active)},keydownSelect:function(){r.current.classList.add(ve().active)},keyupSelect:function(){r.current.classList.remove(ve().active)},keydownRom:function(){a.current.classList.add(ve().active)},keyupRom:function(){a.current.classList.remove(ve().active)}}})),(0,i.jsxs)("div",{className:ve()["pill-buttons"],children:[(0,i.jsx)("div",{ref:r,className:ve()["pill-button"],children:(0,i.jsx)("label",{className:"select",children:"SELECT"})}),(0,i.jsx)("div",{ref:s,className:ve()["pill-button"],children:(0,i.jsx)("label",{className:"start",children:"START"})}),(0,i.jsxs)("div",{ref:a,className:ve()["cart-button"],children:[(0,i.jsx)("input",{id:"ines",type:"file",accept:".nes",onChange:function(t){e.onChange(t.target.files[0])},hidden:!0}),(0,i.jsx)("label",{className:"rom",htmlFor:"ines",children:"ROM"})]})]})})),Pe=s(1190),we=s.n(Pe),Be=n.forwardRef((function(e,t){var s=(0,n.useRef)();return n.useImperativeHandle(t,(function(){return{get canvas(){return s.current}}})),(0,i.jsx)("div",{className:we().screen,children:(0,i.jsx)("div",{className:we().display,children:(0,i.jsx)("canvas",{ref:s,width:e.width,height:e.height})})})})),Se=function(e){var t,s=(0,n.useRef)(),r=(0,n.useRef)(),a=(0,n.useRef)();n.useEffect((function(){document.addEventListener("keyup",(function(e){switch(e.code){case"ArrowUp":r.current.keyupUp(),t&&t.nes&&(t.nes.player1.update(y,!1),t.nes.player2.update(y,!1));break;case"ArrowDown":r.current.keyupDown(),t&&t.nes&&(t.nes.player1.update(p,!1),t.nes.player2.update(p,!1));break;case"ArrowLeft":r.current.keyupLeft(),t&&t.nes&&(t.nes.player1.update(g,!1),t.nes.player2.update(g,!1));break;case"ArrowRight":r.current.keyupRight(),t&&t.nes&&(t.nes.player1.update(f,!1),t.nes.player2.update(f,!1));break;case"Enter":a.current.keyupStart(),t&&t.nes&&(t.nes.player1.update(u,!1),t.nes.player2.update(u,!1));break;case"Space":a.current.keyupSelect(),t&&t.nes&&(t.nes.player1.update(o,!1),t.nes.player2.update(o,!1));break;case"KeyX":r.current.keyupA(),t&&t.nes&&(t.nes.player1.update(d,!1),t.nes.player2.update(d,!1));break;case"KeyZ":r.current.keyupB(),t&&t.nes&&(t.nes.player1.update(l,!1),t.nes.player2.update(l,!1))}e.preventDefault()})),document.addEventListener("keydown",(function(e){switch(e.code){case"ArrowUp":r.current.keydownUp(),t&&t.nes&&(t.nes.player1.update(y,!0),t.nes.player2.update(y,!0));break;case"ArrowDown":r.current.keydownDown(),t&&t.nes&&(t.nes.player1.update(p,!0),t.nes.player2.update(p,!0));break;case"ArrowLeft":r.current.keydownLeft(),t&&t.nes&&(t.nes.player1.update(g,!0),t.nes.player2.update(g,!0));break;case"ArrowRight":r.current.keydownRight(),t&&t.nes&&(t.nes.player1.update(f,!0),t.nes.player2.update(f,!0));break;case"Enter":a.current.keydownStart(),t&&t.nes&&(t.nes.player1.update(u,!0),t.nes.player2.update(u,!0));break;case"Space":a.current.keydownSelect(),t&&t.nes&&(t.nes.player1.update(o,!0),t.nes.player2.update(o,!0));break;case"KeyX":r.current.keydownA(),t&&t.nes&&(t.nes.player1.update(d,!0),t.nes.player2.update(d,!0));break;case"KeyZ":r.current.keydownB(),t&&t.nes&&(t.nes.player1.update(l,!0),t.nes.player2.update(l,!0))}e.preventDefault()}))}));return(0,i.jsxs)("div",{className:h().emulator,children:[(0,i.jsx)(Be,{ref:s,width:e.width,height:e.height}),(0,i.jsx)(be,{}),(0,i.jsx)(m,{ref:r}),(0,i.jsx)(Ae,{ref:a,onChange:function(e){t&&t.intervalID&&clearInterval(t.intervalID);var i=new FileReader;i.onload=function(e){try{(t=new ge(s.current.canvas,new Uint8Array(e.target.result))).start()}catch(r){var i=s.current.canvas.getContext("2d");i.clearRect(0,0,t.width,t.height),i.textAlign="center",i.fillText(r,128,120),t&&t.intervalID&&clearInterval(t.intervalID)}},i.readAsArrayBuffer(e)}})]})};function ke(){return(0,i.jsx)("div",{className:a().root,children:(0,i.jsx)(Se,{width:256,height:240})})}},3933:function(e){e.exports={"action-buttons":"Actions_action-buttons__xRuTr",dpad:"Actions_dpad__EDfKH","up-button":"Actions_up-button__cNOUe",active:"Actions_active__XQQ44","right-button":"Actions_right-button__hCA8E","down-button":"Actions_down-button__fywln","left-button":"Actions_left-button__XNswO","dent-button":"Actions_dent-button__XSIry",arrow:"Actions_arrow__71f4e","up-arrow":"Actions_up-arrow__UxCa8","right-arrow":"Actions_right-arrow__gw_2_","down-arrow":"Actions_down-arrow__5EtF_","left-arrow":"Actions_left-arrow__C5MA6","dent-circle":"Actions_dent-circle__ntkMH","dent-highlight":"Actions_dent-highlight__587WO","ab-button":"Actions_ab-button__K4b8G","a-button":"Actions_a-button__SYl7Z","b-button":"Actions_b-button__q6VfV","button-height":"Actions_button-height__C9PqU"}},214:function(e){e.exports={root:"Home_root__wfVGa"}},3066:function(e){e.exports={logo:"Logo_logo__Gfur8"}},6138:function(e){e.exports={emulator:"NES_emulator__yw_Wn"}},5309:function(e){e.exports={"pill-buttons":"Pills_pill-buttons__kKSYK","pill-button":"Pills_pill-button__SWxRp",active:"Pills_active__G5Lvq","cart-button":"Pills_cart-button__Quk8t"}},1190:function(e){e.exports={screen:"Screen_screen__oxMqR",display:"Screen_display__Q_jJ2"}}},function(e){e.O(0,[774,888,179],(function(){return t=8312,e(e.s=t);var t}));var t=e.O();_N_E=t}]);